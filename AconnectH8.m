function [Jacobi,Hx,Hy,Hz]=AconnectH8(pxn,pyn,pzn,e,n,J)

%F.E.Shape Functions Partial Derivatives&Jacobian matris components 28.12.2006 [A.Ö]
%8NODE-24DOF HEXAHEDRAL SOLID ELEMENT
%Jacobi:Jacobian matrix 
%Hx=d/dx.[Aconnect]
%Hy=d/dy.[Aconnect]
%Hz=d/dz.[Aconnect]
%[px,py,pz]:Global cartesian node coordinates.

X1=pxn(1); Y1=pyn(1); Z1=pzn(1);
X2=pxn(2); Y2=pyn(2); Z2=pzn(2);
X3=pxn(3); Y3=pyn(3); Z3=pzn(3);
X4=pxn(4); Y4=pyn(4); Z4=pzn(4);
X5=pxn(5); Y5=pyn(5); Z5=pzn(5);
X6=pxn(6); Y6=pyn(6); Z6=pzn(6);
X7=pxn(7); Y7=pyn(7); Z7=pzn(7);
X8=pxn(8); Y8=pyn(8); Z8=pzn(8);



%Jacobian matrix components
J11=-(J+1)*(n+1)*X8/8.0+(J+1)*(n+1)*X7/8.0+(J+1)*(1-n)*X6/8.0-(J+1)*(1-n)*X5/8.0-(1-J)*(n+1)*X4/8.0+(1-J)*(n+1)*X3/8.0+(1-J)*(1-n)*X2/8.0-(1-J)*(1-n)*X1/8.0 ;
J12=-(J+1)*(n+1)*Y8/8.0+(J+1)*(n+1)*Y7/8.0+(J+1)*(1-n)*Y6/8.0-(J+1)*(1-n)*Y5/8.0-(1-J)*(n+1)*Y4/8.0+(1-J)*(n+1)*Y3/8.0+(1-J)*(1-n)*Y2/8.0-(1-J)*(1-n)*Y1/8.0 ;
J13=-(J+1)*(n+1)*Z8/8.0+(J+1)*(n+1)*Z7/8.0+(J+1)*(1-n)*Z6/8.0-(J+1)*(1-n)*Z5/8.0-(1-J)*(n+1)*Z4/8.0+(1-J)*(n+1)*Z3/8.0+(1-J)*(1-n)*Z2/8.0-(1-J)*(1-n)*Z1/8.0 ;
J21= (1-e)*(J+1)*X8/8.0+(e+1)*(J+1)*X7/8.0-(e+1)*(J+1)*X6/8.0-(1-e)*(J+1)*X5/8.0+(1-e)*(1-J)*X4/8.0+(e+1)*(1-J)*X3/8.0-(e+1)*(1-J)*X2/8.0-(1-e)*(1-J)*X1/8.0 ;
J22= (1-e)*(J+1)*Y8/8.0+(e+1)*(J+1)*Y7/8.0-(e+1)*(J+1)*Y6/8.0-(1-e)*(J+1)*Y5/8.0+(1-e)*(1-J)*Y4/8.0+(e+1)*(1-J)*Y3/8.0-(e+1)*(1-J)*Y2/8.0-(1-e)*(1-J)*Y1/8.0 ;
J23= (1-e)*(J+1)*Z8/8.0+(e+1)*(J+1)*Z7/8.0-(e+1)*(J+1)*Z6/8.0-(1-e)*(J+1)*Z5/8.0+(1-e)*(1-J)*Z4/8.0+(e+1)*(1-J)*Z3/8.0-(e+1)*(1-J)*Z2/8.0-(1-e)*(1-J)*Z1/8.0 ;
J31= (1-e)*(n+1)*X8/8.0+(e+1)*(n+1)*X7/8.0+(e+1)*(1-n)*X6/8.0+(1-e)*(1-n)*X5/8.0-(1-e)*(n+1)*X4/8.0-(e+1)*(n+1)*X3/8.0-(e+1)*(1-n)*X2/8.0-(1-e)*(1-n)*X1/8.0 ;
J32= (1-e)*(n+1)*Y8/8.0+(e+1)*(n+1)*Y7/8.0+(e+1)*(1-n)*Y6/8.0+(1-e)*(1-n)*Y5/8.0-(1-e)*(n+1)*Y4/8.0-(e+1)*(n+1)*Y3/8.0-(e+1)*(1-n)*Y2/8.0-(1-e)*(1-n)*Y1/8.0 ;
J33= (1-e)*(n+1)*Z8/8.0+(e+1)*(n+1)*Z7/8.0+(e+1)*(1-n)*Z6/8.0+(1-e)*(1-n)*Z5/8.0-(1-e)*(n+1)*Z4/8.0-(e+1)*(n+1)*Z3/8.0-(e+1)*(1-n)*Z2/8.0-(1-e)*(1-n)*Z1/8.0 ;   

%Jacobian matrix 
Jacobi=[J11   J12   J13;
        J21   J22   J23;
        J31   J32   J33];

%Invers Jocabian matrix    
InvJ=Jacobi^-1;
        g11=InvJ(1,1);   g12=InvJ(1,2);   g13=InvJ(1,3);
        g21=InvJ(2,1);   g22=InvJ(2,2);   g23=InvJ(2,3);
        g31=InvJ(3,1);   g32=InvJ(3,2);   g33=InvJ(3,3);    



%Element shape function derivatives
Hx = [-g11*(1-J)*(1-n)/8.0-(1-e)*g13*(1-n)/8.0-(1-e)*g12*(1-J)/8.0  %Hx1
       g11*(1-J)*(1-n)/8.0-(e+1)*g13*(1-n)/8.0-(e+1)*g12*(1-J)/8.0  %Hx2
       g11*(1-J)*(n+1)/8.0-(e+1)*g13*(n+1)/8.0+(e+1)*g12*(1-J)/8.0  %Hx3
      -g11*(1-J)*(n+1)/8.0-(1-e)*g13*(n+1)/8.0+(1-e)*g12*(1-J)/8.0  %Hx4
      -g11*(J+1)*(1-n)/8.0+(1-e)*g13*(1-n)/8.0-(1-e)*g12*(J+1)/8.0  %Hx5
       g11*(J+1)*(1-n)/8.0+(e+1)*g13*(1-n)/8.0-(e+1)*g12*(J+1)/8.0  %Hx6
       g11*(J+1)*(n+1)/8.0+(e+1)*g13*(n+1)/8.0+(e+1)*g12*(J+1)/8.0  %Hx7
      -g11*(J+1)*(n+1)/8.0+(1-e)*g13*(n+1)/8.0+(1-e)*g12*(J+1)/8.0];%Hx8


Hy = [-g21*(1-J)*(1-n)/8.0-(1-e)*g23*(1-n)/8.0-(1-e)*g22*(1-J)/8.0  %Hy1
       g21*(1-J)*(1-n)/8.0-(e+1)*g23*(1-n)/8.0-(e+1)*g22*(1-J)/8.0  %Hy2
       g21*(1-J)*(n+1)/8.0-(e+1)*g23*(n+1)/8.0+(e+1)*g22*(1-J)/8.0  %Hy3
      -g21*(1-J)*(n+1)/8.0-(1-e)*g23*(n+1)/8.0+(1-e)*g22*(1-J)/8.0  %Hy4
      -g21*(J+1)*(1-n)/8.0+(1-e)*g23*(1-n)/8.0-(1-e)*g22*(J+1)/8.0  %Hy5
       g21*(J+1)*(1-n)/8.0+(e+1)*g23*(1-n)/8.0-(e+1)*g22*(J+1)/8.0  %Hy6
       g21*(J+1)*(n+1)/8.0+(e+1)*g23*(n+1)/8.0+(e+1)*g22*(J+1)/8.0  %Hy7
      -g21*(J+1)*(n+1)/8.0+(1-e)*g23*(n+1)/8.0+(1-e)*g22*(J+1)/8.0];%Hy8


Hz = [-g31*(1-J)*(1-n)/8.0-(1-e)*g33*(1-n)/8.0-(1-e)*g32*(1-J)/8.0  %Hz1
       g31*(1-J)*(1-n)/8.0-(e+1)*g33*(1-n)/8.0-(e+1)*g32*(1-J)/8.0  %Hz2
       g31*(1-J)*(n+1)/8.0-(e+1)*g33*(n+1)/8.0+(e+1)*g32*(1-J)/8.0  %Hz3
      -g31*(1-J)*(n+1)/8.0-(1-e)*g33*(n+1)/8.0+(1-e)*g32*(1-J)/8.0  %Hz4
      -g31*(J+1)*(1-n)/8.0+(1-e)*g33*(1-n)/8.0-(1-e)*g32*(J+1)/8.0  %Hz5
       g31*(J+1)*(1-n)/8.0+(e+1)*g33*(1-n)/8.0-(e+1)*g32*(J+1)/8.0  %Hz6
       g31*(J+1)*(n+1)/8.0+(e+1)*g33*(n+1)/8.0+(e+1)*g32*(J+1)/8.0  %Hz7
      -g31*(J+1)*(n+1)/8.0+(1-e)*g33*(n+1)/8.0+(1-e)*g32*(J+1)/8.0 ];%Hz8
        